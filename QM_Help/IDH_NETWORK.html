<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>

<head>
<script type="text/javascript" src="../h.js"></script>

<title>Network setup</title>

<link rel=StyleSheet href="../QM-Help.css">

</head>

<body>

<h1>Network setup</h1>
<p>Quick Macros  must be installed on each computer where it will be used, unless you use <a href="../Other/IDP_PORTABLE.html">portable QM</a>.</p>
<h2>Sharing and deploying QM files</h2>
<p>&nbsp;</p>
<p>If you want to use same <a href="IDH_QML.html">QM file</a> (thereafter <i>file F</i>) on multiple computers or user accounts simultaneously:</p>
<ul>
  <li>Note that in QM 2.4.0 has been changed file format and the way QM opens files.</li>
  <li>While a file is open in QM, other QM instances (computers/accounts) cannot open it, unless all open it as read-only.</li>
  <li>Each computer/user must have its own main file. Add file F to the main file as a shared file (menu File -&gt; Import). It will create a virtual folder with S letter on folder icon, where items from file F will be loaded.</li>
  <li>Normally only single computer (thereafter <i>computer A</i>) should open file F as editable. To prevent other computers opening it as editable (and making unavailable for computer A), on that computers in QM right click the S folder and check Folder Properties -&gt; Shared file -&gt; Load local read-only copy.</li>
  <li>When you make changes in file F on computer A, on other computers QM will load file F (or its copy) when starting or reloading main file. Note that QM does not write changes to .qml files immediately; read more in the <a href="IDH_QML.html">QM files</a> topic.</li>
</ul>
<p>&nbsp;</p>
<p>When QM setup program runs, if it finds file Main.qml in its folder, it installs the file as default main file for that computer user. You can use this feature to automate installing same modified main QM file on multiple computers. For example, will not need to add the shared file F on multiple computers; you can do it on single computer, if the path will be valid on all computers.</p>
<p>&nbsp;</p>
<p>The &quot;Load local read-only copy&quot; feature also is useful in cases when the network file F is unavailable when QM starts. Then QM loads previously used local copy of the file.</p>
<h2>Deploying QM registry settings</h2>
<p>QM saves most its settings in registry 
for each user. To  export to file qmreg5.reg, click Options -&gt; General -&gt; Export settings.</p>
<p>&nbsp;</p>
<p>When QM setup program runs, if finds file qmreg5.reg in its folder, installs the file in QM folder. Then, when QM runs first time on a user account on that computer, it imports QM settings from qmreg5.reg to the registry of that user. It then places &quot;reg loaded&quot;=1 value in the 
  &quot;HKCU\Software\GinDi\QM2\settings&quot; registry key to prevent importing again. Note: This requires administrator privileges (a UAC consent may be shown).</p>
<p>&nbsp;</p>
<p>QM 2.4.0. Custom toolbar position/style settings now are saved in main file, not in registry.</p>
<p>&nbsp;</p>
<p>Note: The exported reg file includes the path of the current main QM file. 
  You may have to open the reg file in Notepad and edit QM file path (&quot;file&quot;), 
  as well as other file paths, if they are different on other computers. In file 
  paths, you can use special folder strings, for example $qm$ (QM program folder) and $my qm$ (My Documents\My QM). Usually don't need editing because QM saves paths with special folder strings.</p>
<h2>Deploying a macro</h2>
<p>To send a macro to other computer, use function <span class="UDF">NetSendMacro</span>. To execute - function <span class="blue">net</span>.</p>
<p>&nbsp;</p>
<p>Read more in <a href="../Commands/IDP_NET.html" class="blue">net</a> topic.</p>
<h2>Registration</h2>
<p>Enter QM registration code on each computer. On multi-user 
  computers, if you are logged on as an administrator, this automatically registers 
  QM for all user accounts.</p>
<h2>Upgrading</h2>
<p>To upgrade QM, install new QM version on each computer.</p>
<p>&nbsp;</p>
<hr>
<p><i>See also: </i><a href="../Other/IDP_SETUP.html">setup command line parameters</a>, <a href="../Other/IDP_LICENSE.html">license</a>.</p>
<p>&nbsp;</p>
</body>

</html>
