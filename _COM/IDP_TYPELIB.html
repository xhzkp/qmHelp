<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>

<head>
<script type="text/javascript" src="../h.js"></script>

<title>typelib</title>

<link rel=StyleSheet href="../QM-Help.css">

</head>

<body>

<h1><a href="../Language/IDP_DECLARATION.html">Declare</a> COM type library</h1>

<h3>Syntax1 - declare a type library by GUID</h3>

<pre class=syntax><b>typelib</b> libname guid vermajor.verminor <i>[</i>lcid<i>]</i> <i>[</i>flags<i>]</i></pre>

<p>&nbsp;</p>

<h3>Syntax2 - declare a type library by file name</h3>

<pre class=syntax><b>typelib</b> libname file <i>[</i>flags<i>]</i></pre>
<p>&nbsp;</p>

<h3>Syntax3 - use a previously declared type library</h3>

<pre class=syntax><b>typelib</b> libname</pre>

<p>&nbsp;</p>

<h3>Parameters</h3>

<div class="parts">
<p> <b>libname</b> - <a href="../Other/IDP_IDENTIFIERS.html">name</a> of type 
library. It can be any name that you want to use to identify the type library 
later in code.</p>

<p> <b>guid</b> - <a href="../Other/IDP_GUID.html">globally unique identifier</a> of type library.</p>

<p> <b>vermajor.verminor</b> - major and minor version. Digits.</p>

<p> <b>lcid</b> - locale identifier. Integer constant. Default: 0 (neutral).</p>
<p><b><a href="../Other/IDP_FLAGS.html">flags</a></b>:</p>
<table class="tflags"><col>
<tr> 
  <td>1</td>
  <td>load on demand. The type library will be loaded into memory 
    only when actually needed.</td>
</tr>
<tr> 
  <td>2</td>
  <td>global scope. Identifiers from this type library can be used anywhere 
    without specifying <b>libname</b>.</td>
</tr>
</table>
<p><a href="../Other/IDP_SEARCHPATHS.html"> <b>file</b></a> - type library file.</p>
</div>
<p>&nbsp; </p>
<h3>Remarks</h3>

<p>To insert this statement, use the <a href="IDP_COM_USAGE.html">COM Libraries 
  dialog</a> (menu Tools -&gt; COM Libraries).</p>
<p>&nbsp;</p>
<h4>Syntax1</h4>
<p>Declares a registered type library.</p>

<p>&nbsp;</p>

<h4>Syntax2</h4>
<p>Declares a type library from <b>file</b>. By default, is 
  used the type library from the first resource in the file<b></b>. To use other 
  resource, append \ and resource index (e.g., &quot;c:\abc.dll\2&quot;).</p>

<p>&nbsp;</p>

<h4>Syntax3</h4>
<p>Makes identifiers from a previously declared type library 
  available in the current macro or function without specifying <b>libname</b>. 
  Also, if the type library is still not loaded, loads.</p>
<p>&nbsp;</p>

<p>A type library usually contains information about one or more COM classes (coclasses) 
  and associated interfaces. Also can contain other declarations, such as dll 
  functions, constants and types. It makes programming easier, because you don't 
  have to manually declare them (<span class="blue">type</span>, <span class="blue">def</span>, 
  <span class="blue">dll</span> and <span class="blue">interface</span> statements). 
  It is either separate file (.tlb, .olb) or part of the component (.dll, .exe, 
  .ocx). Typically, OLE-Automation-enabled applications and ActiveX components 
  provide type libraries.</p>

<p>&nbsp;</p>

<h4>Accessing identifiers declared in type library</h4>

<p>&nbsp;</p>

<p>If a type library is declared with global scope (flag 2), identifiers from 
  it (types, constants, etc) can be used anywhere, without any special syntax. 
Otherwise use syntax <span class=syntax><span class=lib>libname</span>.identifier</span>, 
  unless the type library is declared in the same macro/function. Also, when using <span class=syntax><span class=lib>libname</span>.identifier</span> 
  syntax, the identifier is automatically declared and colored when typing or 
  opening macro.</p>
<p>&nbsp;</p>
<p><i>See also:</i> <a href="../Language/IDP_DIR_SUB.html">sub-function attribute r</a>, <a href="../QM_Help/IDH_FOLDERPROP.html">application folders</a>.</p>

<p>&nbsp;</p>
<h4>Errors</h4>
<p>&nbsp;</p>
<p>If a type library cannot be loaded (file not found, not registered, etc), is 
  generated error, and compilation stops. If you are not sure that the component 
  exists on user's system, you can use <a href="../Language/IDP_DIR_ERR.html" class="dir">#err</a> 
  to mute the error, compile alternative code or call a user-defined function. 
  Even if flag 1 (load on demand) is set, <span class=cod><span class=dir>#err</span> <span class=fu>function</span></span> works: if function returns nonzero, error is not shown.</p>
<p>&nbsp;</p>
<h4>Tips</h4>


<p>To see what is inside type libraries, you can download and istall a type library 
  browser, such as Microsoft's OLE Object Viewer (free).</p>

<p>&nbsp;</p>
<p><i>See also:</i> <a href="../Language/IDP_REF.html" class="blue">ref</a> 
  <a href="../Language/IDP_DECLARATION.html">declarations</a> <a href="../Other/IDP_IDENTIFIERS.html">scope</a></p>
<p>&nbsp;</p>
<h3>Examples</h3>

<pre class=cod><span class=fq>typelib</span> Word {00020905-0000-0000-C000-000000000046} 8.0 0x409
<span class=fq>typelib</span> mytypelib <span class=s>&#34;c:\type libraries\mytl.tlb&#34;</span>

Word.Application wa
<span class=t>int</span> i <span class=o>=</span> mytypelib.MyFunction<span class=p>(</span><span class=n>0</span><span class=p>)</span></pre>

</body>

</html>
